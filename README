> Studying the Impact of Connection Sparsity on Embedding Probability
> and Solution Quality in Capacitively Coupled Ising Machines

  -----------------------------------------------------------------------------------------------
  Fadi El Merheby                      Joren Dumoulin               Marian Verhelst
  ------------------------------------ ---------------------------- -----------------------------
  *ESAT - MICAS*                       *ESAT - MICAS*               *ESAT - MICAS*

  *Katholieke Universiteit Leuven*     *Katholieke Universiteit     *Katholieke Universiteit
                                       Leuven*                      Leuven*

  Leuven, Belgium                      Leuven, Belgium              Leuven, Belgium

  fadi.elmerheby@student.kuleuven.be   joren.dumoulin@kuleuven.be   marian.verhelst@kuleuven.be
  -----------------------------------------------------------------------------------------------

***Abstract*---Ising machines have emerged as a promising non-Von
Neumann computing paradigm for solving NP-complete combinatorial
optimization problems. CMOS-based latch im-plementations offer
scalability and compatibility with mature fabrication processes, but the
choice of coupling topology has a major impact on flexibility, energy
efficiency, and solution quality. While sparse architectures such as
lattices reduce hardware complexity, their effect on embeddability and
performance is less understood. This work systematically studies the
impact of connection sparsity on embedding probability and circuit-level
solution quality using planar and random graphs. We show that planar
graphs exhibit significantly higher embedding success rates on NSEW
lattices, with practical average degree limits close to the theoretical
bound. SPICE simulations in 45 nm CMOS further reveal that an NSEW
lattice with direct intra-chain wiring can outperform a fully connected
machine in solution quality (91.4% vs. 16.2% at strong coupling for**
*N* = 60**), though at a 3.87***×* **higher energy cost. These findings
highlight the trade-off between embeddability, accuracy, and efficiency
in hardware Ising machines.**

***Index Terms*---Ising machine, CMOS, combinatorial optimiza-tion,
sparse architecture, embedding, solution quality, capacitive coupling**

I. INTRODUCTION

> As technology advances, we are increasingly confronted

with larger and more complex Combinatorial Optimization

Problems (COPs). The majority of these problems are clas-

sified as NP-complete, for which no known deterministic

algorithms can provide a solution in polynomial time \[1\],

\[2\]. Solving these problems using traditional Von Neumann

architectures is highly inefficient due to their sequential nature

and the exponential time complexity of these problems.

> To address these limitations, researchers have been explor-

ing alternative computing paradigms, with Ising Machines

emerging as a promising approach \[3\], \[4\]. These are a novel

class of computers inspired by the Ising model, originally

proposed by Lenz and Ising in the 1920s to describe ferro-

magnetism. Among various implementations (e.g., Quantum

Annealing (QA) \[5\], \[6\], Simulated Annealing (SA) \[7\], \[8\]),

CMOS-based Ising Machines have become a topic of signif-

icant research. This is mainly due to the ability of CMOS

> technology to naturally mimic Ising spins through bistable circuits
> known as latches, providing a path towards scalable, affordable, and
> room-temperature operation that avoids the cryogenic cooling
> requirements of QA systems.
>
> Despite this promise, a critical design choice remains un-resolved:
> the hardware topology. Architectures with an all-to-all, fully
> connected approach can represent approximately every Ising problem but
> suffer in terms of scalability, with routing and area costs growing
> quadratically (*O*(*N*2)) \[9\], \[10\]. Meanwhile, sparse
> implementations like lattice-based structures are more efficient in
> area and power, scaling linearly (*O*(*N*)), but this comes at the
> expense of the number of problems they can represent \[11\]--\[13\].
> While this trade-off is often evaluated from a hardware efficiency
> standpoint, systematic studies that evaluate the impact of the
> topology on solution quality remain scarce.
>
> This work addresses that gap by: (1) quantifying embedding success
> rates for planar and random graphs on sparse NSEW lattices to define
> the practical boundaries of problem repre-sentation, and (2)
> performing a rigorous, circuit-level SPICE simulation to compare
> solution quality, convergence time, and energy consumption for
> multiple coupling approaches in both sparse and dense topologies.
>
> II\. BACKGROUND AND EMBEDDING ANALYSIS
>
> *A. Ising Model and Annealing*
>
> The energy of an Ising system is described by the Ising Hamiltonian:
>
> *H* = *−* *i\<j Jijσiσj −* *i* *hiσi* (1)
>
> where *σi ∈{−*1*,* +1*}* are spin variables, and *Jij* represents the
> coupling strengths. A positive (ferromagnetic) coupling favors aligned
> spins (*σiσj* = 1), while a negative (anti-ferromagnetic) coupling
> favors anti-aligned spins (*σiσj* = *−*1). Problems such as Max-Cut
> can be directly mapped to this form, as shown in Fig. 2. The goal of
> an Ising machine is to explore the problem's energy landscape, which
> is often "rugged" with many local minima \[11\]. To overcome this, an
> annealing process is used

to guide the system towards its ground state \[3\], \[14\], as
conceptually shown in Fig. 3.

> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image1.png){width="2.7888888888888888in"
> height="3.9458333333333333in"}

Fig. 1: Ising Model.

> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image2.png){width="2.7888888888888888in"
> height="1.9694433508311462in"}
>
> Fig. 2: MaxCut problem on a 5 node example.

*B. CMOS Latch-Based Architectures*

Recently, much focus has shifted towards implementing Ising spins as
bistable CMOS latches \[15\]. This approach allows for fast, parallel,
and continuous-time operation \[16\]. The latches can be coupled
positively or negatively to model ferromagnetic or anti-ferromagnetic
interactions, as shown in Fig. 4. The area savings of a lattice vs. a
fully-connected BRIM-style machine are quantified in Fig. 5.

> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image3.png){width="3.486111111111111in"
> height="2.1944444444444446in"}
>
> Fig. 3: Energy Curve of an Annealing Processor.
>
> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image4.png){width="3.486111111111111in"
> height="1.0986111111111112in"}
>
> Fig. 4: Positively/Negatively coupled latches.
>
> *C. Embedding Theory*
>
> In hardware, a problem's logical graph *GL* = (*VL, EL*) must be
> embedded into the physical graph *GP* = (*VP , EP* ). When *GP* is
> sparse, a single logical node *vi ∈VL* must often be represented by a
> "chain" of multiple physical nodes in *VP* , which are connected by
> strong ferromagnetic couplings to ensure they act in unison.
>
> A fundamental constraint on embedding is the average node degree, *k*.
> For an NSEW lattice with a maximum degree of 4, a logical graph must
> satisfy *k ≤*4. However, simulations using the 'minorminer' algorithm
> \[17\] show this is not a hard boundary. For *N* = 20, the success
> rate at the theoretical k=4 limit drops to 0.00%, with the 50% success
> threshold occurring at a much lower k=2.85. This discrepancy arises
> from the combinatorial complexity of the embedding search
>
> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image5.png){width="3.486111111111111in"
> height="1.672221128608924in"}
>
> Fig. 5: (a) Area of BRIM vs Lattice (b) Latch and Capacitor area
> scaling.

space and the heuristic nature of the embedding algorithm. Planarity is
another major constraint. By Kuratowski's the-orem \[18\], planar graphs
avoid *K*5 and *K*3*,*3 minors and satisfy *\|EL\| ≤*3*N −*6, which
implies a theoretical k-limit of *k ≤*6 *−*12*/N*. Our results show
planar graphs closely track this limit, achieving near-100% embedding
success at degrees that completely fail for random graphs \[19\].
However, this success comes at a high resource cost; for a 60-node
planar graph, the average longest chain was over 26 nodes, requiring an
average lattice size of 21x21.

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image6.png){width="3.486111111111111in"
height="2.526388888888889in"}

Fig. 6: Embedding success rate for Erd˝os--R´enyi graphs drops to 0% at
*k* = 4 for *N* = 20.

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image7.png){width="3.486111111111111in"
height="2.4930555555555554in"}

Fig. 7: Analysis of practical embedding limits for planar graphs.

III\. METHODOLOGY

*A. Problem Graph Generation*

A Python-based generator created SPICE netlists for each problem
instance. The test suite comprised planar Max-Cut problems, used as a
benchmark for its simplicity and ease of implementation. Graphs were
generated with node counts

> from 10 to 60. To ensure embeddability while testing a range of
> complexities, the edge density *s* was set as *s* = *γ · spb*, where
> *spb* is the maximum density for a graph to be considered planar, and
> the ratio *γ* was varied from 0.1 to 1.0. For each configuration, 50
> random test graphs were generated to ensure statistical significance.
>
> *B. Circuit Modeling and Topologies*

Simulations used a 45 nm CMOS technology model with a 1.1 V supply.
Latches were designed with symmetrical drive strengths (*WP MOS*=360 nm,
*WNMOS*=180 nm) to ensure op-timal bistable behavior. The physical
implementation of the NSEW lattice (Fig. 8) connects a central latch to
its neighbors via differential switches and a programmable coupling
element (Fig. 9). This element can establish one of three paths: an edge
capacitor *Ce*, a short circuit, or a direct coupling capacitor *Cdc*.
Three main architectures were tested: (1) a fully connected (FC)
machine, (2) an NSEW lattice with direct intra-chain wiring
(Lattice-Direct), and (3) an NSEW lattice with capac-itive intra-chain
coupling (Lattice-Cap). The method of intra-chain coupling is critical:
direct wiring enforces unison but risks premature convergence by
creating a larger, stronger"super-latch." Capacitive coupling weakens
this feedback but risks "broken chains" if the coupling is not strong
enough.

> *C. Simulation Framework*
>
> Transient SPICE analysis was performed using NGSPICE. All latches were
> initialized with their Q and Q' terminals at 0V, forcing the network
> into a metastable state from which the system's evolution is driven
> purely by the energy landscape. Simulation time was set to 10ns for
> *Ce \<* 50*fF* and 30ns for larger capacitances to ensure convergence.
> Metrics included normalized solution quality (*H/Hbm*), convergence
> time, and total energy.

IV\. RESULTS AND DISCUSSION

> *A. Solution Quality*
>
> The Lattice-Direct architecture consistently achieved the highest
> solution quality. At strong coupling (*Ce* = 200 fF) and *N* = 60,
> Lattice-Direct achieved 91.4% quality, significantly outperforming the
> FC architecture, which dropped to 16.2% (Fig. 10). In the FC case,
> strong coupling appears to cause pre-mature convergence to a
> suboptimal state, reducing its quality by a factor of 0.18 from its
> weak-coupling performance. The Lattice-Direct quality, by contrast,
> only reduced by a factor of 0.91.
>
> The Lattice-Cap variants performed poorly due to a high probability of
> "broken chains," which introduces large penalty terms into the
> Hamiltonian. At weak coupling (*Ce* = 5 fF), the probability of a
> broken chain for the *r* = 2 case reached as high as 49% for *N* = 60
> (Fig. 11).
>
> *B. Convergence Time*
>
> Surprisingly, convergence time decreased with *N* in strongly coupled
> networks. For the FC architecture at *Ce* = 200 fF, the time dropped
> from 11.46 ns at N=10 to 2.04 ns at N=60, a

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image8.png){width="7.138888888888889in"
height="5.048611111111111in"}

Fig. 8: Circuit schematic showing one central latch connected to its
four NSEW neighbors.

> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image9.png){width="3.138888888888889in"
> height="2.279166666666667in"}

Fig. 9: Programmable coupling element showing the three possible paths.

5.62*×* reduction. This counter-intuitive behavior is attributed to the
decrease in the effective impedance that each node sees in a larger,
more interconnected network, allowing the system to settle faster
despite the increase in total capacitance.

> *C. Energy Consumption*
>
> Lattice-Direct's accuracy came at a significant energy cost. At *N* =
> 60 and *Ce* = 200 fF, it consumed 12.63 pJ on average---3.87*×* more
> than the FC architecture (Fig. 13). This is due to the direct wiring
> of chains creating an effective"super-latch," which is larger and
> consumes more dynamic power during switching. The regular structure of
> the sparse lattice appears to facilitate a more effective annealing
> process, but this advantage is paid for in energy.
>
> V. LIMITATIONS AND FUTURE WORK
>
> Our use of Level 1 MOS models captures first-order dy-namics but omits
> second-order effects; full PDK validation is needed. Embedding success
> rates depend on heuristic solver randomness; deterministic
> placement--routing could improve results. Finally, dynamic annealing
> schedules could be ex-plored to further enhance solution quality.

VI\. CONCLUSION

> We quantitatively compared embedding and solution quality for fully
> connected and sparse NSEW lattice CMOS Ising machines. Planar graphs
> embed far more efficiently on sparse

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image10.png){width="3.486111111111111in"
height="4.6722222222222225in"}

Fig. 10: Solution quality vs. *N* for weak (5 fF, top) and strong (200
fF, bottom) coupling.

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image11.png){width="3.486111111111111in"
height="1.0583333333333333in"}

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image12.png){width="3.486111111111111in"
height="1.058332239720035in"}

Fig. 11: Broken Chain probability vs. *N* for weak (5 fF, top) and
strong (200 fF, bottom) coupling.

> ![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image13.png){width="3.486111111111111in"
> height="4.6722222222222225in"}
>
> Fig. 12: Convergence time (in ns) vs. *N* for weak (5 fF, top) and
> strong (200 fF, bottom) coupling.
>
> lattices, and for these embeddable problems, Lattice-Direct topologies
> can significantly outperform FC in accuracy. How-ever, the energy cost
> is substantial, underscoring the critical trade-off between solution
> quality and energy efficiency in the design of large-scale hardware
> Ising machines.

REFERENCES

> \[1\] W. Kim, M. Choi, M. Lee, and H.-J. Yoo, "A CMOS annealing system
> for Ising computing," KAIST, Tech. Rep. EECS-2023-138, 2023.
>
> \[2\] F. Barahona, "On the computational complexity of Ising spin
> glass models," *Journal of Physics A: Mathematical and General*, vol.
> 15, no. 10, pp. 3241--3253, 1982.
>
> \[3\] N. Mohseni, P. L. McMahon, and T. Byrnes, "Ising machines as
> hard-ware solvers for combinatorial optimization problems," *Nature
> Reviews Physics*, vol. 4, pp. 363--379, 2022.
>
> \[4\] A. Lucas, "Ising formulations of many NP problems," *Frontiers
> in Physics*, vol. 2, p. 5, 2014.
>
> \[5\] T. Kadowaki and H. Nishimori, "Quantum annealing in the
> transverse Ising model," *Physical Review E*, vol. 58, no. 5, pp.
> 5355--5363, 1998. \[6\] M. W. Johnson, M. H. S. Amin, S. Gildert, T.
> Lanting, F. Hamze, N. Dickson, R. Harris, A. J. Berkley, J. Johansson,
> P. Bunyk, and et al.,"Quantum annealing with manufactured spins,"
> *Nature*, vol. 473, pp. 194--198, 2011.
>
> \[7\] L. Ingber, "Simulated annealing: Practice versus theory,"
> *Mathematical and Computer Modelling*, vol. 18, no. 11, pp. 29--57,
> 1993.
>
> \[8\] M. Davidson, "Solving computationally complex problems with
> Ising machines," *Nature Electronics*, 2024.

![](vertopal_2e1823a208774e77aff2aa21a1bee3c0/media/image14.png){width="3.486111111111111in"
height="4.763888888888889in"}

Fig. 13: Energy consumption vs. *N* for weak and strong coupling.

> \[9\] Y. Wang, Y. Cen, and X. Fong, "Design framework for ising
> machines with bistable latch-based spins and all-to-all resistive
> coupling," in *2024 IEEE International Symposium on Circuits and
> Systems (ISCAS)*, 2024, pp. 1--5.

\[10\] A. Mallick, Z. Zhao, M. K. Bashar, S. Alam, M. M. Islam, Y. Xiao,
Y. Xu, A. Aziz, V. Narayanan, K. Ni, and et al., "CMOS-compatible Ising
machines built using bistable latches coupled through ferroelectric
transistor arrays," in *2022 IEEE Symposium on VLSI Technology and
Circuits (VLSI Technology and Circuits)*, 2022, pp. 1--2.

\[11\] Y. Su, T. T.-H. Kim, and B. Kim, "Flexspin: A scalable CMOS ising
machine with 256 flexible spin processing elements for solving complex
combinatorial optimization problems," in *2022 IEEE International
Solid-State Circuits Conference (ISSCC)*, 2022, pp. 1--3.

\[12\] M. Yamaoka, C. Yoshimura, M. Hayashi, T. Okuyama, H. Aoki, and H.
Mizuno, "20k-spin ising chip for combinational optimization problem with
CMOS annealing," in *2015 IEEE International Solid-State Circuits
Conference (ISSCC)*, 2015, pp. 434--436.

\[13\] M. M. H. Sajeeb, N. A. Aadit, T. Wu, C. Smith, D. Chinmay, A.
Raut, K. Y. Camsari, C. Delacour, and T. Srimani, "Scalable connectivity
for Ising machines: Dense to sparse," *arXiv preprint arXiv:2503.01177*,
2025.

\[14\] S. Razmkhah, J.-Y. Huang, M. Kamal, and M. Pedram, "SAIM:
Scalable analog ising machine for solving quadratic binary optimization
prob-lems," *arXiv preprint arXiv:2410.16079*, 2024.

\[15\] J. Roychowdhury, "Bistable latch ising machines," in
*Unconventional* *Computation and Natural Computation*. Springer, Cham,
2021, pp. 131--148.

\[16\] J. Bae, W. Oh, J. Koo, C. Yu, and B. Kim, "CTLE-Ising: A
continuous-time latch-based ising machine featuring one-shot fully
parallel spin

> updates and equalization of spin states," *IEEE Journal of Solid-State
> Circuits*, vol. 59, no. 1, pp. 173--183, 2024.
>
> \[17\] J. Cai, B. Macready, and A. Roy, "A practical heuristic for
> finding graph minors," *arXiv preprint arXiv:1406.2742*, 2014.
>
> \[18\] D. B. West, *Introduction to Graph Theory*. Prentice Hall,
> 2001, vol. 2. \[19\] M. Noy, V. Ravelomanana, and J. Ru´e, "The
> probability of planarity of a random graph near the critical point,"
> *Discrete Mathematics & Theoretical Computer Science*, vol. AS, 2013.
